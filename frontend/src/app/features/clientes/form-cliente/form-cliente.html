<div class="form-container">
  <!-- Header -->
  <div class="form-header">
    <div class="container">
      <h1>
        <i class="fas" [class.fa-user-plus]="!isEditMode" [class.fa-user-edit]="isEditMode"></i>
        {{ isEditMode ? 'Editar Cliente' : 'Nuevo Cliente' }}
      </h1>
      <p>{{ isEditMode ? 'Actualiza la información del cliente' : 'Ingresa los datos del nuevo cliente' }}</p>
    </div>
  </div>

  <!-- Form Content -->
  <div class="container mt-4">
    <!-- Loading State -->
    <div class="text-center my-5" *ngIf="isLoading">
      <div class="spinner-border text-primary" role="status" style="width: 3rem; height: 3rem;">
        <span class="visually-hidden">Cargando...</span>
      </div>
      <p class="mt-3 text-muted">Cargando información del cliente...</p>
    </div>

    <!-- Form Card -->
    <div class="row justify-content-center" *ngIf="!isLoading">
      <div class="col-lg-8">
        <!-- Success Message -->
        <div class="alert alert-success" *ngIf="successMessage">
          <i class="fas fa-check-circle"></i>
          {{ successMessage }}
        </div>

        <!-- Error Message -->
        <div class="alert alert-danger" *ngIf="errorMessage">
          <i class="fas fa-exclamation-circle"></i>
          {{ errorMessage }}
        </div>

        <div class="card form-card">
          <div class="card-body">
            <form [formGroup]="clienteForm" (ngSubmit)="onSubmit()">
              <!-- Nombre -->
              <div class="mb-4">
                <label for="nombre" class="form-label">
                  <i class="fas fa-user"></i>
                  Nombre Completo
                  <span class="text-danger">*</span>
                </label>
                <input
                  type="text"
                  class="form-control"
                  id="nombre"
                  formControlName="nombre"
                  placeholder="Ej: Juan Pérez"
                  [class.is-invalid]="nombre?.invalid && nombre?.touched"
                  [class.is-valid]="nombre?.valid && nombre?.touched"
                />
                <div class="invalid-feedback" *ngIf="nombre?.invalid && nombre?.touched">
                  {{ getErrorMessage('nombre') }}
                </div>
              </div>

              <!-- Email -->
              <div class="mb-4">
                <label for="email" class="form-label">
                  <i class="fas fa-envelope"></i>
                  Email
                  <span class="text-danger">*</span>
                </label>
                <input
                  type="email"
                  class="form-control"
                  id="email"
                  formControlName="email"
                  placeholder="Ej: [email protected]"
                  [class.is-invalid]="email?.invalid && email?.touched"
                  [class.is-valid]="email?.valid && email?.touched"
                />
                <div class="invalid-feedback" *ngIf="email?.invalid && email?.touched">
                  {{ getErrorMessage('email') }}
                </div>
              </div>

              <!-- Teléfono -->
              <div class="mb-4">
                <label for="telefono" class="form-label">
                  <i class="fas fa-phone"></i>
                  Teléfono
                  <span class="text-danger">*</span>
                </label>
                <input
                  type="text"
                  class="form-control"
                  id="telefono"
                  formControlName="telefono"
                  placeholder="0000-0000"
                  [class.is-invalid]="telefono?.invalid && telefono?.touched"
                  [class.is-valid]="telefono?.valid && telefono?.touched"
                />
                <div class="invalid-feedback" *ngIf="telefono?.invalid && telefono?.touched">
                  {{ getErrorMessage('telefono') }}
                </div>
                <small class="form-text text-muted">
                  Formato: 0000-0000
                </small>
              </div>

              <!-- Dirección -->
              <div class="mb-4">
                <label for="direccion" class="form-label">
                  <i class="fas fa-map-marker-alt"></i>
                  Dirección
                </label>
                <textarea
                  class="form-control"
                  id="direccion"
                  formControlName="direccion"
                  rows="2"
                  placeholder="Ej: Colonia Escalón, San Salvador"
                  [class.is-invalid]="direccion?.invalid && direccion?.touched"
                  [class.is-valid]="direccion?.valid && direccion?.touched"
                ></textarea>
                <div class="invalid-feedback" *ngIf="direccion?.invalid && direccion?.touched">
                  {{ getErrorMessage('direccion') }}
                </div>
              </div>

              <!-- DUI y NIT en dos columnas -->
              <div class="row">
                <div class="col-md-6">
                  <!-- DUI -->
                  <div class="mb-4">
                    <label for="dui" class="form-label">
                      <i class="fas fa-id-card"></i>
                      DUI
                    </label>
                    <input
                      type="text"
                      class="form-control"
                      id="dui"
                      formControlName="dui"
                      placeholder="00000000-0"
                      [class.is-invalid]="dui?.invalid && dui?.touched"
                      [class.is-valid]="dui?.valid && dui?.touched"
                    />
                    <div class="invalid-feedback" *ngIf="dui?.invalid && dui?.touched">
                      {{ getErrorMessage('dui') }}
                    </div>
                    <small class="form-text text-muted">
                      Formato: 00000000-0
                    </small>
                  </div>
                </div>

                <div class="col-md-6">
                  <!-- NIT -->
                  <div class="mb-4">
                    <label for="nit" class="form-label">
                      <i class="fas fa-file-invoice"></i>
                      NIT
                    </label>
                    <input
                      type="text"
                      class="form-control"
                      id="nit"
                      formControlName="nit"
                      placeholder="0000-000000-000-0"
                      [class.is-invalid]="nit?.invalid && nit?.touched"
                      [class.is-valid]="nit?.valid && nit?.touched"
                    />
                    <div class="invalid-feedback" *ngIf="nit?.invalid && nit?.touched">
                      {{ getErrorMessage('nit') }}
                    </div>
                    <small class="form-text text-muted">
                      Formato: 0000-000000-000-0
                    </small>
                  </div>
                </div>
              </div>

              <hr class="my-4">

              <!-- Botones de acción -->
              <div class="d-flex justify-content-between align-items-center">
                <button
                  type="button"
                  class="btn btn-outline-secondary btn-lg"
                  (click)="onCancel()"
                  [disabled]="isSaving"
                >
                  <i class="fas fa-times"></i>
                  Cancelar
                </button>

                <button
                  type="submit"
                  class="btn btn-primary btn-lg"
                  [disabled]="isSaving || clienteForm.invalid"
                >
                  <span *ngIf="!isSaving">
                    <i class="fas" [class.fa-save]="isEditMode" [class.fa-plus]="!isEditMode"></i>
                    {{ isEditMode ? 'Actualizar' : 'Crear' }} Cliente
                  </span>
                  <span *ngIf="isSaving">
                    <span class="spinner-border spinner-border-sm me-2" role="status"></span>
                    Guardando...
                  </span>
                </button>
              </div>

              <!-- Información de campos requeridos -->
              <div class="mt-3">
                <small class="text-muted">
                  <span class="text-danger">*</span> Campos requeridos
                </small>
              </div>
            </form>
          </div>
        </div>

        <!-- Botón de regreso -->
        <div class="text-center mt-4">
          <a routerLink="/clientes" class="text-decoration-none">
            <i class="fas fa-arrow-left"></i>
            Volver a la lista de clientes
          </a>
        </div>
      </div>
    </div>
  </div>
</div>
